<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: store/RouteStore.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: store/RouteStore.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import { action, makeAutoObservable } from "mobx";
import Route from "./models/Route";

/**
 * @typedef {Object} RouteStoreSerialized
 * @property {import("./models/Route").RouteSerialized[]} routes
 */

class RouteStore {
	gameStore;

	/** @type {Route[]} */
	routes = [];

	/** @type {Route|null}*/
	currentRoute = null;

	/** @type {Route|null}*/
	highlightedRoute = null;

	/**
	 * @param {import("./GameStore").default} gameStore
	 * @param {RouteSerialized[]|undefined} routes
	 * */
	constructor(gameStore, routes = []) {
		makeAutoObservable(this, { gameStore: false, initCurrentRoute: action });

		this.gameStore = gameStore;

		routes.forEach(r => {
			if (!(r instanceof Route)) throw new Error("Invalid route data");
		});
		this.routes = routes;
	}

	addRoute = route => {
		this.tracks.push(route);
	};

	deleteRoute = routeId => {
		const routeToDeleteIndex = this.routes.findIndex(r => r.id === routeId);
		if (routeToDeleteIndex === -1) return;

		this.routes[routeToDeleteIndex].cleanup();
		this.routes.splice(routeToDeleteIndex, 1);
	};

	// --------------------------------
	// --------------------------------
	// Current Route related methods
	// --------------------------------

	/** creates a new route
	 * @returns {void}
	 */
	initCurrentRoute = () => {
		this.currentRoute = new Route([], this.gameStore);
	};

	/**
	 * @param {Station} station
	 * @returns {string|null} error
	 */
	addToCurrentRoute = station => {
		return this.currentRoute.addStation(station.name, this.gameStore.stationStore.stationsMap);
	};

	/**
	 * @param {Station} station
	 * @returns {void}
	 */
	removeFromCurrentRoute = station => {
		this.currentRoute.removeStation(station.name);
	};

	/**
	 * Accepts current route and adds it to the routes list
	 * @returns {boolean} success
	 * */
	acceptCurrentRoute = () => {
		if (this.currentRoute.stations.length &lt; 2) return false;

		this.currentRoute.draft = false;
		this.routes.push(this.currentRoute);
		this.currentRoute = null;
		return true;
	};

	discardCurrentRoute = () => {
		this.currentRoute?.cleanup();
		this.currentRoute = null;
	};

	// --------------------------------
	// --------------------------------
	// Highlighted Route related methods
	// --------------------------------

	setHighlightedRoute = route => {
		this.highlightedRoute = route;
	};

	/**
	 * @returns {RouteStoreSerialized}
	 */
	toJSON() {
		return {
			routes: this.routes.map(route => route.toJSON()).filter(Boolean)
		};
	}

	/**
	 * @param {RouteStoreSerialized} data
	 * @param {import("./GameStore").default} gameStore
	 * @returns {RouteStore}
	 */
	static fromJSON(data, gameStore) {
		const routes = data.routes.map(routeData => Route.fromJSON(routeData, gameStore));
		return new RouteStore(gameStore, routes);
	}

	/**
	 * @param {number} id
	 * @returns {Route|undefined}
	 */
	getRouteById(id) {
		return this.routes.find(route => route.id === id);
	}
}

export default RouteStore;
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="GameStore.html">GameStore</a></li><li><a href="Route.html">Route</a></li><li><a href="RouteStore.html">RouteStore</a></li><li><a href="Station.html">Station</a></li><li><a href="Track.html">Track</a></li></ul><h3>Global</h3><ul><li><a href="global.html#cartesianToGeographic">cartesianToGeographic</a></li><li><a href="global.html#findPath">findPath</a></li><li><a href="global.html#geographicToCartesian">geographicToCartesian</a></li><li><a href="global.html#pointNearestCircle">pointNearestCircle</a></li><li><a href="global.html#reconstructPath">reconstructPath</a></li><li><a href="global.html#useGameStore">useGameStore</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.4</a> on Sun Jan 26 2025 10:59:33 GMT+0100 (czas Å›rodkowoeuropejski standardowy)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
